{"ast":null,"code":"/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WorkQueue = require('./WorkQueue');\nvar mod = require('../util/mod');\nfunction WorkPool(opts) {\n  this._concurrency = opts && opts.concurrency || 1;\n  this._paused = opts && !!opts.paused || false;\n  this._pool = [];\n  for (var i = 0; i < this._concurrency; i++) {\n    this._pool.push(new WorkQueue(opts));\n  }\n  this._next = 0;\n}\nWorkPool.prototype.length = function () {\n  var len = 0;\n  for (var i = 0; i < this._pool.length; i++) {\n    len += this._pool[i].length();\n  }\n  return len;\n};\nWorkPool.prototype.push = function (fn, cb) {\n  var i = this._next;\n  var cancel = this._pool[i].push(fn, cb);\n  this._next = mod(this._next + 1, this._concurrency);\n  return cancel;\n};\nWorkPool.prototype.pause = function () {\n  if (!this._paused) {\n    this._paused = true;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].pause();\n    }\n  }\n};\nWorkPool.prototype.resume = function () {\n  if (this._paused) {\n    this._paused = false;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].resume();\n    }\n  }\n};\nmodule.exports = WorkPool;","map":{"version":3,"names":["WorkQueue","require","mod","WorkPool","opts","_concurrency","concurrency","_paused","paused","_pool","i","push","_next","prototype","length","len","fn","cb","cancel","pause","resume","module","exports"],"sources":["E:/VR/node_modules/marzipano/src/collections/WorkPool.js"],"sourcesContent":["/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WorkQueue = require('./WorkQueue');\nvar mod = require('../util/mod');\n\n\nfunction WorkPool(opts) {\n  this._concurrency = opts && opts.concurrency || 1;\n  this._paused = opts && !!opts.paused || false;\n\n  this._pool = [];\n  for (var i = 0; i < this._concurrency; i++) {\n    this._pool.push(new WorkQueue(opts));\n  }\n\n  this._next = 0;\n}\n\n\nWorkPool.prototype.length = function() {\n  var len = 0;\n  for (var i = 0; i < this._pool.length; i++) {\n    len += this._pool[i].length();\n  }\n  return len;\n};\n\n\nWorkPool.prototype.push = function(fn, cb) {\n  var i = this._next;\n  var cancel = this._pool[i].push(fn, cb);\n  this._next = mod(this._next + 1, this._concurrency);\n  return cancel;\n};\n\n\nWorkPool.prototype.pause = function() {\n  if (!this._paused) {\n    this._paused = true;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].pause();\n    }\n  }\n};\n\n\nWorkPool.prototype.resume = function() {\n  if (this._paused) {\n    this._paused = false;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].resume();\n    }\n  }\n};\n\n\nmodule.exports = WorkPool;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZ,IAAIA,SAAS,GAAGC,OAAO,CAAC,aAAa,CAAC;AACtC,IAAIC,GAAG,GAAGD,OAAO,CAAC,aAAa,CAAC;AAGhC,SAASE,QAAQA,CAACC,IAAI,EAAE;EACtB,IAAI,CAACC,YAAY,GAAGD,IAAI,IAAIA,IAAI,CAACE,WAAW,IAAI,CAAC;EACjD,IAAI,CAACC,OAAO,GAAGH,IAAI,IAAI,CAAC,CAACA,IAAI,CAACI,MAAM,IAAI,KAAK;EAE7C,IAAI,CAACC,KAAK,GAAG,EAAE;EACf,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACL,YAAY,EAAEK,CAAC,EAAE,EAAE;IAC1C,IAAI,CAACD,KAAK,CAACE,IAAI,CAAC,IAAIX,SAAS,CAACI,IAAI,CAAC,CAAC;EACtC;EAEA,IAAI,CAACQ,KAAK,GAAG,CAAC;AAChB;AAGAT,QAAQ,CAACU,SAAS,CAACC,MAAM,GAAG,YAAW;EACrC,IAAIC,GAAG,GAAG,CAAC;EACX,KAAK,IAAIL,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACD,KAAK,CAACK,MAAM,EAAEJ,CAAC,EAAE,EAAE;IAC1CK,GAAG,IAAI,IAAI,CAACN,KAAK,CAACC,CAAC,CAAC,CAACI,MAAM,CAAC,CAAC;EAC/B;EACA,OAAOC,GAAG;AACZ,CAAC;AAGDZ,QAAQ,CAACU,SAAS,CAACF,IAAI,GAAG,UAASK,EAAE,EAAEC,EAAE,EAAE;EACzC,IAAIP,CAAC,GAAG,IAAI,CAACE,KAAK;EAClB,IAAIM,MAAM,GAAG,IAAI,CAACT,KAAK,CAACC,CAAC,CAAC,CAACC,IAAI,CAACK,EAAE,EAAEC,EAAE,CAAC;EACvC,IAAI,CAACL,KAAK,GAAGV,GAAG,CAAC,IAAI,CAACU,KAAK,GAAG,CAAC,EAAE,IAAI,CAACP,YAAY,CAAC;EACnD,OAAOa,MAAM;AACf,CAAC;AAGDf,QAAQ,CAACU,SAAS,CAACM,KAAK,GAAG,YAAW;EACpC,IAAI,CAAC,IAAI,CAACZ,OAAO,EAAE;IACjB,IAAI,CAACA,OAAO,GAAG,IAAI;IACnB,KAAK,IAAIG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACL,YAAY,EAAEK,CAAC,EAAE,EAAE;MAC1C,IAAI,CAACD,KAAK,CAACC,CAAC,CAAC,CAACS,KAAK,CAAC,CAAC;IACvB;EACF;AACF,CAAC;AAGDhB,QAAQ,CAACU,SAAS,CAACO,MAAM,GAAG,YAAW;EACrC,IAAI,IAAI,CAACb,OAAO,EAAE;IAChB,IAAI,CAACA,OAAO,GAAG,KAAK;IACpB,KAAK,IAAIG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACL,YAAY,EAAEK,CAAC,EAAE,EAAE;MAC1C,IAAI,CAACD,KAAK,CAACC,CAAC,CAAC,CAACU,MAAM,CAAC,CAAC;IACxB;EACF;AACF,CAAC;AAGDC,MAAM,CAACC,OAAO,GAAGnB,QAAQ"},"metadata":{},"sourceType":"script","externalDependencies":[]}