{"ast":null,"code":"/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class Dynamics\n * @classdesc\n *\n * Represents how a control parameter changes. Used in the events emitted by\n * {@link ControlMethod}.\n *\n * @property {number} offset Parameter changed by a fixed value\n * @property {number} velocity Parameter is changing at this velocity\n * @property {number} friction The velocity will decrease at this rate\n */\nfunction Dynamics() {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n}\nDynamics.equals = function (d1, d2) {\n  return d1.velocity === d2.velocity && d1.friction === d2.friction && d1.offset === d2.offset;\n};\nDynamics.prototype.equals = function (other) {\n  return Dynamics.equals(this, other);\n};\nDynamics.prototype.update = function (other, elapsed) {\n  if (other.offset) {\n    // If other has an offset, make this.offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += other.offset;\n  }\n  var offsetFromVelocity = this.offsetFromVelocity(elapsed);\n  if (offsetFromVelocity) {\n    // If there is an offset to add from the velocity, make this offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += offsetFromVelocity;\n  }\n  this.velocity = other.velocity;\n  this.friction = other.friction;\n};\nDynamics.prototype.reset = function () {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n};\nDynamics.prototype.velocityAfter = function (elapsed) {\n  if (!this.velocity) {\n    return null;\n  }\n  if (this.friction) {\n    return decreaseAbs(this.velocity, this.friction * elapsed);\n  }\n  return this.velocity;\n};\nDynamics.prototype.offsetFromVelocity = function (elapsed) {\n  elapsed = Math.min(elapsed, this.nullVelocityTime());\n  var velocityEnd = this.velocityAfter(elapsed);\n  var averageVelocity = (this.velocity + velocityEnd) / 2;\n  return averageVelocity * elapsed;\n};\nDynamics.prototype.nullVelocityTime = function () {\n  if (this.velocity == null) {\n    return 0;\n  }\n  if (this.velocity && !this.friction) {\n    return Infinity;\n  }\n  return Math.abs(this.velocity / this.friction);\n};\nfunction decreaseAbs(num, dec) {\n  if (num < 0) {\n    return Math.min(0, num + dec);\n  }\n  if (num > 0) {\n    return Math.max(0, num - dec);\n  }\n  return 0;\n}\nmodule.exports = Dynamics;","map":{"version":3,"names":["Dynamics","velocity","friction","offset","equals","d1","d2","prototype","other","update","elapsed","offsetFromVelocity","reset","velocityAfter","decreaseAbs","Math","min","nullVelocityTime","velocityEnd","averageVelocity","Infinity","abs","num","dec","max","module","exports"],"sources":["E:/VR/node_modules/marzipano/src/controls/Dynamics.js"],"sourcesContent":["/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class Dynamics\n * @classdesc\n *\n * Represents how a control parameter changes. Used in the events emitted by\n * {@link ControlMethod}.\n *\n * @property {number} offset Parameter changed by a fixed value\n * @property {number} velocity Parameter is changing at this velocity\n * @property {number} friction The velocity will decrease at this rate\n */\nfunction Dynamics() {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n}\n\nDynamics.equals = function(d1, d2) {\n  return d1.velocity === d2.velocity && d1.friction === d2.friction && d1.offset === d2.offset;\n};\n\nDynamics.prototype.equals = function(other) {\n  return Dynamics.equals(this, other);\n};\n\nDynamics.prototype.update = function(other, elapsed) {\n  if (other.offset) {\n    // If other has an offset, make this.offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += other.offset;\n  }\n\n  var offsetFromVelocity = this.offsetFromVelocity(elapsed);\n  if (offsetFromVelocity) {\n    // If there is an offset to add from the velocity, make this offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += offsetFromVelocity;\n  }\n\n  this.velocity = other.velocity;\n  this.friction = other.friction;\n};\n\nDynamics.prototype.reset = function() {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n};\n\n\nDynamics.prototype.velocityAfter = function(elapsed) {\n  if (!this.velocity) {\n    return null;\n  }\n  if (this.friction) {\n    return decreaseAbs(this.velocity, this.friction *elapsed);\n  }\n  return this.velocity;\n};\n\nDynamics.prototype.offsetFromVelocity = function(elapsed) {\n  elapsed = Math.min(elapsed, this.nullVelocityTime());\n\n  var velocityEnd = this.velocityAfter(elapsed);\n  var averageVelocity = (this.velocity + velocityEnd) / 2;\n\n  return averageVelocity * elapsed;\n};\n\n\nDynamics.prototype.nullVelocityTime = function() {\n  if (this.velocity == null) {\n    return 0;\n  }\n  if (this.velocity && !this.friction) {\n    return Infinity;\n  }\n  return Math.abs(this.velocity / this.friction);\n};\n\nfunction decreaseAbs(num, dec) {\n  if (num < 0) {\n    return Math.min(0, num + dec);\n  }\n  if (num > 0) {\n    return Math.max(0, num - dec);\n  }\n  return 0;\n}\n\nmodule.exports = Dynamics;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}